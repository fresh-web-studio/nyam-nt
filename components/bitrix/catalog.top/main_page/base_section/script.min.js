(function(){if(!!window.JCCatalogTopComponent){return}window.JCCatalogTopComponent=function(a){this.formPosting=false;this.siteId=a.siteId||"";this.ajaxId=a.ajaxId||"";this.template=a.template||"";this.componentPath=a.componentPath||"";this.parameters=a.parameters||"";this.bigData=a.bigData||{enabled:false};this.container=document.querySelector('[data-entity="'+a.container+'"]');if(this.bigData.enabled&&BX.util.object_keys(this.bigData.rows).length>0){BX.cookie_prefix=this.bigData.js.cookiePrefix||"";BX.cookie_domain=this.bigData.js.cookieDomain||"";BX.current_server_time=this.bigData.js.serverTime;BX.ready(BX.delegate(this.bigDataLoad,this))}if(a.initiallyShowHeader){BX.ready(BX.delegate(this.showHeader,this))}if(a.deferredLoad){BX.ready(BX.delegate(this.deferredLoad,this))}};window.JCCatalogTopComponent.prototype={bigDataLoad:function(){var a="https://analytics.bitrix.info/crecoms/v1_0/recoms.php",b=BX.ajax.prepareData(this.bigData.params);if(b){a+=(a.indexOf("?")!==-1?"&":"?")+b}var c=BX.delegate(function(d){this.sendRequest({action:"deferredLoad",bigData:"Y",items:d&&d.items||[],rid:d&&d.id,count:this.bigData.count,rowsRange:this.bigData.rowsRange,shownIds:this.bigData.shownIds})},this);BX.ajax({method:"GET",dataType:"json",url:a,timeout:3,onsuccess:c,onfailure:c})},deferredLoad:function(){this.sendRequest({action:"deferredLoad"})},sendRequest:function(b){var a={siteId:this.siteId,template:this.template,parameters:this.parameters};if(this.ajaxId){a.AJAX_ID=this.ajaxId}BX.ajax({url:this.componentPath+"/ajax.php"+(document.location.href.indexOf("clear_cache=Y")!==-1?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:60,data:BX.merge(a,b),onsuccess:BX.delegate(function(c){if(!c||!c.JS){return}BX.ajax.processScripts(BX.processHTML(c.JS).SCRIPT,false,BX.delegate(function(){this.showAction(c,b)},this))},this)})},showAction:function(a,b){if(!b){return}switch(b.action){case"deferredLoad":this.processDeferredLoadAction(a,b.bigData==="Y");break}},processDeferredLoadAction:function(b,c){if(!b){return}var a=c?this.bigData.rows:{};this.processItems(b.items,BX.util.array_keys(a))},processItems:function(f,a){if(!f){return}var g=BX.processHTML(f,false),d=BX.create("DIV");var c,b,e;d.innerHTML=g.HTML;c=d.querySelectorAll('[data-entity="items-row"]');if(c.length){this.showHeader(true);for(b in c){if(c.hasOwnProperty(b)){e=a?this.container.querySelectorAll('[data-entity="items-row"]'):false;c[b].style.opacity=0;if(e&&BX.type.isDomNode(e[a[b]])){e[a[b]].parentNode.insertBefore(c[b],e[a[b]])}else{this.container.appendChild(c[b])}}}new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(i){for(var h in c){if(c.hasOwnProperty(h)){c[h].style.opacity=i.opacity/100}}},complete:function(){for(var h in c){if(c.hasOwnProperty(h)){c[h].removeAttribute("style")}}}}).animate()}BX.ajax.processScripts(g.SCRIPT)},showHeader:function(b){var a=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}}),c;if(a&&BX.type.isDomNode(a)){c=a.querySelector('[data-entity="header"]');if(c&&c.getAttribute("data-showed")!="true"){c.style.display="";if(b){new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(d){c.style.opacity=d.opacity/100},complete:function(){c.removeAttribute("style");c.setAttribute("data-showed","true")}}).animate()}else{c.style.opacity=100}}}}}})();