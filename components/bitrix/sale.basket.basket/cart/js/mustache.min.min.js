(function e(a,b){if(typeof exports==="object"&&exports&&typeof exports.nodeName!=="string"){b(exports)}else{if(typeof define==="function"&&define.amd){define(["exports"],b)}else{a.Mustache={};b(a.Mustache)}}})(this,function e(G){var I=Object.prototype.toString;var L=Array.isArray||function V(a){return I.call(a)==="[object Array]"};function P(a){return typeof a==="function"}function H(a){return L(a)?"array":typeof a}function Z(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function K(b,a){return b!=null&&typeof b==="object"&&a in b}var D=RegExp.prototype.test;function N(b,a){return D.call(b,a)}var S=/\S/;function X(a){return !N(S,a)}var J={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Q(a){return String(a).replace(/[&<>"'`=\/]/g,function a(b){return J[b]})}var C=/\s*/;var W=/\s+/;var R=/\s*=/;var B=/\s*\}/;var z=/#|\^|\/|>|\{|&|=|!/;function A(ai,y){if(!ai){return[]}var af=[];var v=[];var ac=[];var n=false;var ad=false;function ah(){if(n&&!ad){while(ac.length){delete v[ac.pop()]}}else{ac=[]}n=false;ad=false}var ab,ag,m;function t(f){if(typeof f==="string"){f=f.split(W,2)}if(!L(f)||f.length!==2){throw new Error("Invalid tags: "+f)}ab=new RegExp(Z(f[0])+"\\s*");ag=new RegExp("\\s*"+Z(f[1]));m=new RegExp("\\s*"+Z("}"+f[1]))}t(y||G.tags);var b=new M(ai);var c,ae,d,a,w,aa;while(!b.eos()){c=b.pos;d=b.scanUntil(ab);if(d){for(var k=0,g=d.length;k<g;++k){a=d.charAt(k);if(X(a)){ac.push(v.length)}else{ad=true}v.push(["text",a,c,c+1]);c+=1;if(a==="\n"){ah()}}}if(!b.scan(ab)){break}n=true;ae=b.scan(z)||"name";b.scan(C);if(ae==="="){d=b.scanUntil(R);b.scan(R);b.scanUntil(ag)}else{if(ae==="{"){d=b.scanUntil(m);b.scan(B);b.scanUntil(ag);ae="&"}else{d=b.scanUntil(ag)}}if(!b.scan(ag)){throw new Error("Unclosed tag at "+b.pos)}w=[ae,d,c,b.pos];v.push(w);if(ae==="#"||ae==="^"){af.push(w)}else{if(ae==="/"){aa=af.pop();if(!aa){throw new Error('Unopened section "'+d+'" at '+c)}if(aa[1]!==d){throw new Error('Unclosed section "'+aa[1]+'" at '+c)}}else{if(ae==="name"||ae==="{"||ae==="&"){ad=true}else{if(ae==="="){t(d)}}}}}aa=af.pop();if(aa){throw new Error('Unclosed section "'+aa[1]+'" at '+b.pos)}return Y(O(v))}function O(f){var b=[];var d,g;for(var a=0,c=f.length;a<c;++a){d=f[a];if(d){if(d[0]==="text"&&g&&g[0]==="text"){g[1]+=d[1];g[3]=d[3]}else{b.push(d);g=d}}}return b}function Y(h){var d=[];var g=d;var l=[];var c,f;for(var b=0,k=h.length;b<k;++b){c=h[b];switch(c[0]){case"#":case"^":g.push(c);l.push(c);g=c[4]=[];break;case"/":f=l.pop();f[5]=c[2];g=l.length>0?l[l.length-1][4]:d;break;default:g.push(c)}}return d}function M(a){this.string=a;this.tail=a;this.pos=0}M.prototype.eos=function V(){return this.tail===""};M.prototype.scan=function V(a){var b=this.tail.match(a);if(!b||b.index!==0){return""}var c=b[0];this.tail=this.tail.substring(c.length);this.pos+=c.length;return c};M.prototype.scanUntil=function V(a){var b=this.tail.search(a),c;switch(b){case -1:c=this.tail;this.tail="";break;case 0:c="";break;default:c=this.tail.substring(0,b);this.tail=this.tail.substring(b)}this.pos+=c.length;return c};function F(b,a){this.view=b;this.cache={".":this.view};this.parent=a}F.prototype.push=function V(a){return new F(a,this)};F.prototype.lookup=function V(f){var h=this.cache;var i;if(h.hasOwnProperty(f)){i=h[f]}else{var g=this,c,d,b=false;while(g){if(f.indexOf(".")>0){i=g.view;c=f.split(".");d=0;while(i!=null&&d<c.length){if(d===c.length-1){b=K(i,c[d])}i=i[c[d++]]}}else{i=g.view[f];b=K(g.view,f)}if(b){break}g=g.parent}h[f]=i}if(P(i)){i=i.call(this.view)}return i};function j(){this.cache={}}j.prototype.clearCache=function V(){this.cache={}};j.prototype.parse=function V(c,d){var a=this.cache;var b=a[c];if(b==null){b=a[c+":"+(d||G.tags).join(":")]=A(c,d)}return b};j.prototype.render=function V(b,d,f){var a=this.parse(b);var c=d instanceof F?d:new F(d);return this.renderTokens(a,c,f,b)};j.prototype.renderTokens=function V(v,b,d,h){var w="";var m,c,p;for(var g=0,k=v.length;g<k;++g){p=undefined;m=v[g];c=m[0];if(c==="#"){p=this.renderSection(m,b,d,h)}else{if(c==="^"){p=this.renderInverted(m,b,d,h)}else{if(c===">"){p=this.renderPartial(m,b,d,h)}else{if(c==="&"){p=this.unescapedValue(m,b)}else{if(c==="name"){p=this.escapedValue(m,b)}else{if(c==="text"){p=this.rawValue(m)}}}}}}if(p!==undefined){w+=p}}return w};j.prototype.renderSection=function V(v,b,w,m){var g=this;var n="";var h=b.lookup(v[1]);function i(a){return g.render(a,b,w)}if(!h){return}if(L(h)){for(var k=0,d=h.length;k<d;++k){n+=this.renderTokens(v[4],b.push(h[k]),w,m)}}else{if(typeof h==="object"||typeof h==="string"||typeof h==="number"){n+=this.renderTokens(v[4],b.push(h),w,m)}else{if(P(h)){if(typeof m!=="string"){throw new Error("Cannot use higher-order sections without the original template")}h=h.call(b.view,m.slice(v[3],v[5]),i);if(h!=null){n+=h}}else{n+=this.renderTokens(v[4],b,w,m)}}}return n};j.prototype.renderInverted=function V(d,g,c,f){var b=g.lookup(d[1]);if(!b||L(b)&&b.length===0){return this.renderTokens(d[4],g,c,f)}};j.prototype.renderPartial=function V(a,c,d){if(!d){return}var b=P(d)?d(a[1]):d[a[1]];if(b!=null){return this.renderTokens(this.parse(b),c,d,b)}};j.prototype.unescapedValue=function V(a,b){var c=b.lookup(a[1]);if(c!=null){return c}};j.prototype.escapedValue=function V(b,c){var a=c.lookup(b[1]);if(a!=null){return G.escape(a)}};j.prototype.rawValue=function V(a){return a[1]};G.name="mustache.js";G.version="2.3.0";G.tags=["{{","}}"];var q=new j;G.clearCache=function V(){return q.clearCache()};G.parse=function V(a,b){return q.parse(a,b)};G.render=function V(a,b,c){if(typeof a!=="string"){throw new TypeError('Invalid template! Template should be a "string" but "'+H(a)+'" was given as the first argument for mustache#render(template, view, partials)')}return q.render(a,b,c)};G.to_html=function V(d,g,c,b){var f=G.render(d,g,c);if(P(b)){b(f)}else{return f}};G.escape=Q;G.Scanner=M;G.Context=F;G.Writer=j;return G});